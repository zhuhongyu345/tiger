<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <script type="text/javascript" src="scripts/jquery/jquery-1.7.1.js"></script>
    <script type="text/javascript" src="scripts/config.js"></script>
    <link href="style/authority/basic_layout.css" rel="stylesheet" type="text/css">
    <link href="style/authority/common_style.css" rel="stylesheet" type="text/css">
    <title>stock</title>
    <script type="text/javascript">
        $(document).ready(function () {


            $(".ui_input_txt02").keydown(function (e) {
                if (e.keyCode == 13) {
                    search();
                }
            });
            $(".ui_select01").change(function () {
                search();
            });


            $("#deleteSome").click(function () {
                deleteOne();
            });
            $("#flushHard").click(function () {
                flush("1");
            });
            $("#flush").click(function () {
                flush("0");
            });
            $("#addTag").click(function () {
                changeTag("1");
            });
            $("#delTag").click(function () {
                changeTag("0");
            });
            $("#search").click(function () {
                search();
            });
            $("#addOne").click(function () {
                addOne();
            });
            search();
        });

        function addOne() {
            $.ajax({
                type: "post",
                url: hostC + "/addOne",
                data: {
                    name: $("#name").val(),
                    type: $("#type").val(),
                },
                success: function (result) {
                    console.log("flush")
                    console.log(result)
                }
            });
            search()
        }

        function deleteOne() {
            $("input:checkbox").each(function () {
                if ($(this).is(':checked')) {
                    checkedValue = $(this).val()
                    console.log(checkedValue)
                    $.ajax({
                        type: "post",
                        url: hostC + "/deleteOne",
                        data: {id: checkedValue},
                        success: function (result) {
                            console.log("flush")
                            console.log(result)
                        }
                    });
                }
            })
            search()
        }

        function changeTag(yn) {
            $("input:checkbox").each(function () {
                if ($(this).is(':checked')) {
                    checkedValue = $(this).val()
                    console.log(checkedValue)
                    $.ajax({
                        type: "post",
                        url: hostC + "/tagOne",
                        data: {
                            id: checkedValue,
                            tag: yn,
                        },
                        success: function (result) {
                            console.log(checkedValue + ":tag")
                            console.log(result)
                            search()
                        }
                    });
                }
            })
        }

        function flush(hard) {
            $.ajax({
                type: "post",
                url: hostC + "/flush",
                data: {
                    hard: hard,
                    type: $("#type").val(),
                },
                success: function (result) {
                    console.log("flush")
                    console.log(result)
                }
            });
        }

        function search() {
            req = {
                size: $("#size").val(),
                skip: $("#skip").val(),
                sortType: $("#sortType").val(),
                sort: $("#sort").val(),
                liangbi: $("#liangbi").val(),
                name: $("#name").val(),
                type: $("#type").val(),
                hlLow: $("#hlLow").val(),
                hlHigh: $("#hlHigh").val(),
                peHigh: $("#peHigh").val(),
                peLow: $("#peLow").val(),
                yield: $("#yield").val(),
                priceLow: $("#priceLow").val(),
                priceHigh: $("#priceHigh").val(),
                cjlHigh: $("#cjlHigh").val(),
                cjlLow: $("#cjlLow").val(),
                zclHigh: $("#zclHigh").val(),
                zclLow: $("#zclLow").val(),


            };
            console.log(req)
            $.ajax({
                type: "post",
                url: hostC + "/search",
                data: req,
                success: function (result) {
                    res = (result)
                    tableBody = '';
                    totc = 0
                    for (var i in res) {
                        totc++
                        d = res[i];
                        t = "UNKNOWN";
                        bdType = "us-"
                        ftType = "-US"
                        if (d.Type == 2) {
                            t = 'USE';
                        } else if (d.Type == 1) {
                            t = 'USS';
                        } else if (d.Type == 3) {
                            t = 'CNS';
                            bdType = "ab-"
                            ftType = "-SH"
                        }
                        link = "https://xueqiu.com/S/" + d.name
                        linkbd = "https://gushitong.baidu.com/stock/" + bdType + d.name
                        linkft = "https://www.futunn.com/stock/" + d.name + ftType
                        linkHistory = "./pe_history.html?name=" + d.name
                        linkwn = "https://www.webull.com.sg/ticker/nasdaq-" + d.name
                        linkwn2 = "https://www.webull.com.sg/ticker/nyse-" + d.name

                        tableBody += '<tr>' +
                            '<td><input type="checkbox" name="IDCheck" value="' + d.id + '" class="acb"/></td>' +
<!--                            '<td>' + d.id + '</td>' +-->
                            '<td>' + d.name + '</td>' +
                            '<td>' + d.chn + '</td>' +
                            '<td>' + t + '</td>' +
                            '<td>' + d.pe + '</td>' +
                            '<td>' + d.yield + '</td>' +
                            // '<td>' + d.shizhi + '</td>' +
                            '<td>' + d.price + '</td>' +
                            // '<td>' + d.huanshoulv + '</td>' +
                            // '<td>' + d.liangbi + '</td>' +
                            // '<td>' + d.l52 + '</td>' +
                            // '<td>' + d.h52 + '</td>' +
                            '<td>' + d.hl + '</td>' +
                            '<td>' + d.cjlrateday + '</td>' +
                            '<td>' + d.zcrate + '</td>' +
                            '<td>' + d.zcweek + '</td>' +
                            '<td>' + d.up + '</td>' +
                            '<td>' +
                            '<a target="_blank" href="' + linkHistory + '" class="edit">GO</a>' +
                            '</td>' +
                            '<td>' +
                            '<a target="_blank" href="' + linkft + '" class="edit">F</a>' +
                            '<a target="_blank" href="' + link + '" class="edit">X</a>' +
                            '<a target="_blank" href="' + linkbd + '" class="edit">B</a>' +
                            '<a target="_blank" href="' + linkwn + '" class="edit">W</a>' +
                            '<a target="_blank" href="' + linkwn2 + '" class="edit">N</a>' +
                            '</td>' +
                            '</tr>'
                    }
                    $("#tableData").html(tableBody)
                    console.log('count:')
                    console.log(totc)
                }
            });
        }
    </script>
    <style>
        .alt td {
            background: black !important;
        }
    </style>
</head>
<body>

<form id="submitForm" name="submitForm" action="" method="post">
    <div id="container">
        <div class="">
            <div class="ui_text_indent">
                <div id="box_border" style="height: 120px;">
                    <div id="box_top">SEARCH</div>
                    <div id="box_center">
                        CODE<input type="text" id="name" style="width:60px;" class="ui_input_txt02"/>
                        TYPE
                        <select class="ui_select01" style="width:85px;" id="type">
                            <option value="">ALL</option>
                            <option value="-1">SELF</option>
                            <option value="1" selected>USS</option>
                            <option value="2">USE</option>
                            <option value="3">CNS</option>
                        </select>
                        &nbsp;&nbsp;L_H<input type="text" id="hlLow" style="width:60px;" class="ui_input_txt02"/>
                        -<input type="text" id="hlHigh" style="width:60px;" class="ui_input_txt02"/>
                        &nbsp;&nbsp;PE<input type="text" value="0" id="peLow" style="width:60px;"
                                             class="ui_input_txt02"/>
                        -<input type="text" id="peHigh" style="width:60px;" class="ui_input_txt02"/>
                        &nbsp;&nbsp;DIV<input type="text" id="yield" style="width:60px;" class="ui_input_txt02"/>
                        <!--                        &nbsp;&nbsp;LB<input type="text" id="liangbi" style="width:60px;" class="ui_input_txt02"/>-->
                        &nbsp;&nbsp;PRICE<input type="text" id="priceLow" style="width:60px;" class="ui_input_txt02"/>
                        -<input type="text" id="priceHigh" style="width:60px;" class="ui_input_txt02"/>
                        <!--                         成交率<input type="text" id="cjlLow" style="width:60px;" class="ui_input_txt02"/>-->
                        <!--                        -<input type="text" id="cjlHigh" style="width:60px;" class="ui_input_txt02"/>-->
                        ZCD<input type="text" id="zclLow" style="width:60px;" class="ui_input_txt02"/>
                        -<input type="text" id="zclHigh" style="width:60px;" class="ui_input_txt02"/>
                        &nbsp;&nbsp;ORDER
                        <select class="ui_select01" id="sort" style="width:80px;">
                            <option value="id">ID</option>
                            <option value="hl">LorH</option>
                            <option value="pe">PE</option>
                            <option value="yield">DIV</option>
                            <option value="liangbi">LB</option>
                            <option value="price">PRICE</option>
                            <option value="cjlrateday">CJ</option>
                            <option value="zcrate">ZC_D</option>
                            <option value="zcweek" selected>ZC_W</option>
                        </select>
                        <select class="ui_select01" id="sortType" style="width:50px;">
                            <option value="asc">ASC</option>
                            <option value="desc" selected>DESC</option>
                        </select>
                        skip
                        <input type="text" id="skip" class="ui_input_txt02" style="width:50px;"/>
                        size
                        <input type="text" id="size" class="ui_input_txt02" style="width:50px;" value="1000"/>


                    </div>
                    <div id="box_bottom" style="margin-top: 0px;">
                        <input type="button" style="background-color: greenyellow" value="ADD-O" class="ui_input_btn01"
                               id="addOne"/>
                        <input type="button" style="background-color: limegreen" value="ADD-S" class="ui_input_btn01"
                               id="addTag"/>
                        <input type="button" style="background-color: mediumvioletred" value="DEL-S"
                               class="ui_input_btn01" id="delTag"/>
                        <input type="button" style="background-color: palevioletred" value="FLU-H"
                               class="ui_input_btn01" id="flushHard"/>
                        <input type="button" style="background-color: darkred" value="DEL" class="ui_input_btn01"
                               id="deleteSome"/>
                        <input type="button" style="background-color: limegreen" value="FLU" class="ui_input_btn01"
                               id="flush"/>
                        <input type="button" style="background-color: limegreen" value="Q" class="ui_input_btn01"
                               id="search"/>
                    </div>
                </div>
            </div>
        </div>
        <div class="ui_content">
            <div class="ui_tb">
                <table class="table" cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
                    <tr>
                        <th width="30"><input type="checkbox" id="all" onclick="selectOrClearAllCheckbox(this);"/>
                        </th>
<!--                        <th>ID</th>-->
                        <th>CODE</th>
                        <th style="width:230px;">NAME</th>
                        <th style="width:83px;">TYPE</th>
                        <th>PE</th>
                        <th>DIV</th>
                        <th>PRICE</th>
                        <th>LorH</th>
                        <th>BUY</th>
                        <th>ZC_D</th>
                        <th>ZC_W</th>
                        <th>TIME</th>
                        <th style="width:39px;">HPE</th>
                        <th style="width:103px;">LINE</th>
                    </tr>
                    <tbody id="tableData"></tbody>
                </table>
            </div>
        </div>
    </div>
</form>
</body>
</html>
